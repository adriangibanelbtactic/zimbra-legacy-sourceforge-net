<%@ page buffer="8kb" autoFlush="true" %>
<%@ page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>
<%@ taglib prefix="zm" uri="com.zimbra.zm" %>
<%@ taglib prefix="mo" uri="com.zimbra.mobileclient" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<fmt:setBundle basename="/msgs/ZhMsg" scope="session"/>
<mo:handleError>
    <zm:getMailbox var="mailbox"/>
    <c:set var="action" value="${empty param.paction ? param.action : param.paction}" scope="request"/>
    <zm:computeSearchContext var="context" usecache="true"/>
</mo:handleError>

 <%-- switch based on context search types --%>
<c:choose>
    <c:when test="${context.isConversationSearch and action eq 'view'}">
        <mo:convView context="${context}"/>
    </c:when>
    <c:when test="${context.isConversationSearch}">
        <mo:convListView context="${context}"/>
    </c:when>
    <c:when test="${context.isMessageSearch and action eq 'view'}">
        <mo:messageView context="${context}"/>
    </c:when>
    <c:when test="${context.isMessageSearch}">
        <mo:messageListView context="${context}"/>
    </c:when>
    <c:when test="${context.isContactSearch and action eq'view'}">
        <mo:contactView context="${context}"/>
    </c:when>
    <c:when test="${context.isContactSearch}">
        <mo:contactListView context="${context}"/>
    </c:when>
    <c:otherwise>
        <fmt:message key="error" var="title"/>
        <mo:view mailbox="${mailbox}" title="${title}" context="${context}">
            <fmt:message key="ztaglib.TAG_EXCEPTION"/>
        </mo:view>
    </c:otherwise>
</c:choose>
